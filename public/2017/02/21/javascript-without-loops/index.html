<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>正确使用JavaScript数组 - Jim Home</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="leejimqiu"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="leejimqiu"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="首先，我们可以简单地认为缩进就是代码复杂性的指标（尽管很粗略）。因为缩进越多代表我们的嵌套越多，因此代码就越复杂。今天就拿数组来做具体的例子，来展示以下如何抛弃循环，减少缩进，正确地使用JavaScript数组。"><meta property="og:type" content="blog"><meta property="og:title" content="正确使用JavaScript数组"><meta property="og:url" content="http://africans.com/2017/02/21/javascript-without-loops/"><meta property="og:site_name" content="Jim Home"><meta property="og:description" content="首先，我们可以简单地认为缩进就是代码复杂性的指标（尽管很粗略）。因为缩进越多代表我们的嵌套越多，因此代码就越复杂。今天就拿数组来做具体的例子，来展示以下如何抛弃循环，减少缩进，正确地使用JavaScript数组。"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://africans.com/img/og_image.png"><meta property="article:published_time" content="2017-02-20T16:08:29.000Z"><meta property="article:modified_time" content="2020-05-23T06:07:18.000Z"><meta property="article:author" content="leejimqiu"><meta property="article:tag" content="JavaScript"><meta property="article:tag" content="Array"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://africans.com/2017/02/21/javascript-without-loops/"},"headline":"正确使用JavaScript数组","image":["http://africans.com/img/og_image.png"],"datePublished":"2017-02-20T16:08:29.000Z","dateModified":"2020-05-23T06:07:18.000Z","author":{"@type":"Person","name":"leejimqiu"},"publisher":{"@type":"Organization","name":"Jim Home","logo":{"@type":"ImageObject","url":"http://africans.com/img/logo.svg"}},"description":"首先，我们可以简单地认为缩进就是代码复杂性的指标（尽管很粗略）。因为缩进越多代表我们的嵌套越多，因此代码就越复杂。今天就拿数组来做具体的例子，来展示以下如何抛弃循环，减少缩进，正确地使用JavaScript数组。"}</script><link rel="canonical" href="http://africans.com/2017/02/21/javascript-without-loops/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?6638f74329d0f52c5cdafdadb58010af";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Jim Home" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/leejim"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2017-02-20T16:08:29.000Z" title="2/21/2017, 12:08:29 AM">2017-02-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-05-23T06:07:18.000Z" title="5/23/2020, 2:07:18 PM">2020-05-23</time></span><span class="level-item">17 minutes read (About 2505 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">正确使用JavaScript数组</h1><div class="content"><p>首先，我们可以简单地认为缩进就是代码复杂性的指标（尽管很粗略）。因为缩进越多代表我们的嵌套越多，因此代码就越复杂。今天就拿数组来做具体的例子，来展示以下如何抛弃循环，减少缩进，正确地使用JavaScript数组。</p>
<span id="more"></span>

<blockquote>
<p>“…a loop is an imperative control structure that’s hard to reuse and difficult to plug in to other operations. In addition, it implies code that’s constantly changing or mutating in response to new iterations.”<br>－Luis Atencio</p>
</blockquote>
<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>我们都知道，循环结构就是会无形地提高代码的复杂性。那我们现在看看在JavaScript上的循环是如何工作的。</p>
<p>在JavaScript上至少有四五种循环的方式，其中最基础的就是<code>while</code>循环了。讲例子前，先设定一个函数和数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// oodlify :: String -&gt; String</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oodlify</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/[aeiou]/g</span>, <span class="string">&#x27;oodle&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> input = [</span><br><span class="line">    <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Paul&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;George&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Ringo&#x27;</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>那么，如果我们现在要使用<code>oodlify</code>函数操作一下数组里每个元素的话，如果我们使用<code>while</code>循环的话，是这样子的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> len = input.length;</span><br><span class="line"><span class="keyword">let</span> output = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> item = input[i];</span><br><span class="line">    <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line"></span><br><span class="line">    output.push(newItem);</span><br><span class="line">    i = i + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里就有许多无谓的，但是又不得不做的工作。比如用<code>i</code>这个计数器来记住当前循环的位置，而且需要把<code>i</code>初始化成0，每次循环还要加一；比如要拿<code>i</code>和数组的长度<code>len</code>对比，这样才知道循环到什么时候停止。</p>
<p>这时为了让清晰一点，我们可以使用JavaScript为我们提供的<code>for</code>循环：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> len = input.length;</span><br><span class="line"><span class="keyword">let</span> output = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i = i + <span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> item = input[i];</span><br><span class="line">    <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line"></span><br><span class="line">    output.push(newItem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>for</code>循环的好处就是把与业务代码无关的计数逻辑放在了括号里面了。</p>
<p>对比起<code>while</code>循环虽有一定改进，但是也会发生类似忘记给计数器<code>i</code>加一而导致死循环的情况。</p>
<p>现在回想一下我们的最初目的：就只是给数组的每一个元素执行一下<code>oodlify</code>函数而已。其实我们真的不想关什么计数器。</p>
<p>因此，<code>ES2015</code>就为我们提供了一个全新的可以让我们忽略计数器的循环结构－ <code>for...of</code>循环 ：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> output = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> input) &#123;</span><br><span class="line">    <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line">    output.push(newItem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方式是不是简单多了！我们可以注意到，计数器和对比语句都没了。</p>
<p>如果我们这就满足的话，我们的目标也算完成了，代码的确是简洁了不少。</p>
<p>但是其实，我们可以对JavaScript的数组再深入挖掘一下，更上一层楼。</p>
<h2 id="Mapping"><a href="#Mapping" class="headerlink" title="Mapping"></a>Mapping</h2><p><code>for...of</code>循环的确比<code>for</code>循环简洁不少，但是我们仍然写了一些不必要的初始化代码，比如<code>output</code>数组，以及把每个操作过后的值push进去。</p>
<p>其实我们有办法写得更简单明了一点的。不过，现在我们来放大一下这个问题先：</p>
<p>如果我们有两个数组需要使用<code>oodlify</code>函数操作的话呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fellowship = [</span><br><span class="line">    <span class="string">&#x27;frodo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sam&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gandalf&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;aragorn&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;boromir&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;legolas&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gimli&#x27;</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> band = [</span><br><span class="line">    <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Paul&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;George&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Ringo&#x27;</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>很明显，我们就要这样循环两个数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> bandoodle = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> band) &#123;</span><br><span class="line">    <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line">    bandoodle.push(newItem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> floodleship = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> fellowship) &#123;</span><br><span class="line">    <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line">    floodleship.push(newItem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这的确可以完成我们的目标，但是这样写得有点累赘。我们可以重构一下以减少重复的代码。因此我们可以创建一个函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oodlifyArray</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> output = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> input) &#123;</span><br><span class="line">        <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line">        output.push(newItem);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bandoodle = oodlifyArray(band);</span><br><span class="line"><span class="keyword">let</span> floodleship = oodlifyArray(fellowship);</span><br></pre></td></tr></table></figure>

<p>这样是不是好看多了。但是问题来了，如果我们要使用其他函数来操作这个数组的话呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">izzlify</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/[aeiou]+/g</span>, <span class="string">&#x27;izzle&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时，我们前面创建的<code>oodlifyArray</code>函数帮不了我们了。不过如果我们这时创建<code>izzlifyArray</code>函数的话，代码不就又有许多重复的部分了吗？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oodlifyArray</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> output = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> input) &#123;</span><br><span class="line">        <span class="keyword">let</span> newItem = oodlify(item);</span><br><span class="line">        output.push(newItem);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">izzlifyArray</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> output = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> input) &#123;</span><br><span class="line">        <span class="keyword">let</span> newItem = izzlify(item);</span><br><span class="line">        output.push(newItem);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这两个函数是不是及其相似呢。</p>
<p>如果此时我们将其抽象成一个模式的话呢：<strong>我们希望传入一个数组和一个函数，然后映射每个数组元素，最后输出一个数组</strong>。这个模式就称为<code>mapping</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">map</span>(<span class="params">f, a</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> output = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> a) &#123;</span><br><span class="line">        output.push(f(item));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实我们并不需要自己手动写<code>mapping</code>函数，因为JavaScript提供了内置的<code>map</code>函数给我们使用，此时我们的代码是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> bandoodle     = band.map(oodlify);</span><br><span class="line"><span class="keyword">let</span> floodleship   = fellowship.map(oodlify);</span><br><span class="line"><span class="keyword">let</span> bandizzle     = band.map(izzlify);</span><br><span class="line"><span class="keyword">let</span> fellowshizzle = fellowship.map(izzlify);</span><br></pre></td></tr></table></figure>

<h2 id="Reducing"><a href="#Reducing" class="headerlink" title="Reducing"></a>Reducing</h2><p>此时<code>map</code>是很方便了，但是并不能覆盖我们所有的循环需要。</p>
<p>如果此时我们需要累计数组中的所有数组呢。我们假设有一个这样的数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> heroes = [</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Hulk&#x27;</span>, <span class="attr">strength</span>: <span class="number">90000</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Spider-Man&#x27;</span>, <span class="attr">strength</span>: <span class="number">25000</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Hawk Eye&#x27;</span>, <span class="attr">strength</span>: <span class="number">136</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Thor&#x27;</span>, <span class="attr">strength</span>: <span class="number">100000</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Black Widow&#x27;</span>, <span class="attr">strength</span>: <span class="number">136</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Vision&#x27;</span>, <span class="attr">strength</span>: <span class="number">5000</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Scarlet Witch&#x27;</span>, <span class="attr">strength</span>: <span class="number">60</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Mystique&#x27;</span>, <span class="attr">strength</span>: <span class="number">120</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Namora&#x27;</span>, <span class="attr">strength</span>: <span class="number">75000</span>&#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>如果我们要找到<code>strength</code>最大的那个的元素的话，使用<code>for...of</code>循环是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> strongest = &#123;<span class="attr">strength</span>: <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hero.strength &gt; strongest.strength) &#123;</span><br><span class="line">        strongest = hero;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果此时我们想累计一下所有的<code>strength</code>的话，循环里面就是这样的了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> combinedStrength = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    combinedStrength += hero.strength;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这两个例子我们都需要初始化一个变量来配合我们的操作。合并两个例子的话就是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greaterStrength</span>(<span class="params">champion, contender</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (contender.strength &gt; champion.strength) ? contender : champion;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addStrength</span>(<span class="params">tally, hero</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> tally + hero.strength;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例子 1</span></span><br><span class="line"><span class="keyword">const</span> initialStrongest = &#123;<span class="attr">strength</span>: <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> working = initialStrongest;</span><br><span class="line"><span class="keyword">for</span> (hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    working = greaterStrength(working, hero);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> strongest = working;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例子 2</span></span><br><span class="line"><span class="keyword">const</span> initialCombinedStrength = <span class="number">0</span>;</span><br><span class="line">working = initialCombinedStrength;</span><br><span class="line"><span class="keyword">for</span> (hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    working = addStrength(working, hero);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> combinedStrength = working;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此时我们可以抽象成这样一个函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">f, initialVal, a</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> working = initialVal;</span><br><span class="line">    <span class="keyword">for</span> (item <span class="keyword">of</span> a) &#123;</span><br><span class="line">        working = f(working, item);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> working;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实这个方法JavaScript也提供了内置函数，就是<code>reduce</code>函数。这时代码是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> strongestHero = heroes.reduce(greaterStrength, &#123;<span class="attr">strength</span>: <span class="number">0</span>&#125;);</span><br><span class="line"><span class="keyword">const</span> combinedStrength = heroes.reduce(addStrength, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h2><p>前面的<code>map</code>函数是将数组的全部元素执行同个操作之后输出一个同样大小的数组；</p>
<p><code>reduce</code>则是将数组的全部值执行操作之后，最终输出一个值。</p>
<p>如果此时我们只是需要提取几个元素到一个数组内呢？为了更好得解释，我们来扩充一下之前的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> heroes = [</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Hulk&#x27;</span>, <span class="attr">strength</span>: <span class="number">90000</span>, <span class="attr">sex</span>: <span class="string">&#x27;m&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Spider-Man&#x27;</span>, <span class="attr">strength</span>: <span class="number">25000</span>, <span class="attr">sex</span>: <span class="string">&#x27;m&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Hawk Eye&#x27;</span>, <span class="attr">strength</span>: <span class="number">136</span>, <span class="attr">sex</span>: <span class="string">&#x27;m&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Thor&#x27;</span>, <span class="attr">strength</span>: <span class="number">100000</span>, <span class="attr">sex</span>: <span class="string">&#x27;m&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Black Widow&#x27;</span>, <span class="attr">strength</span>: <span class="number">136</span>, <span class="attr">sex</span>: <span class="string">&#x27;f&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Vision&#x27;</span>, <span class="attr">strength</span>: <span class="number">5000</span>, <span class="attr">sex</span>: <span class="string">&#x27;m&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Scarlet Witch&#x27;</span>, <span class="attr">strength</span>: <span class="number">60</span>, <span class="attr">sex</span>: <span class="string">&#x27;f&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Mystique&#x27;</span>, <span class="attr">strength</span>: <span class="number">120</span>, <span class="attr">sex</span>: <span class="string">&#x27;f&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">&#x27;Namora&#x27;</span>, <span class="attr">strength</span>: <span class="number">75000</span>, <span class="attr">sex</span>: <span class="string">&#x27;f&#x27;</span>&#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>现在假设我们要做的两件事：</p>
<ol>
<li>找到<code>sex = f</code>的元素</li>
<li>找到<code>strength &gt; 500</code>的元素</li>
</ol>
<p>如果使用<code>for...of</code>循环的话，是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> femaleHeroes = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hero.sex === <span class="string">&#x27;f&#x27;</span>) &#123;</span><br><span class="line">        femaleHeroes.push(hero);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> superhumans = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hero.strength &gt;= <span class="number">500</span>) &#123;</span><br><span class="line">        superhumans.push(hero);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于有重复的地方，那么我们就把不同的地方抽取出来：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFemaleHero</span>(<span class="params">hero</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (hero.sex === <span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isSuperhuman</span>(<span class="params">hero</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (hero.strength &gt;= <span class="number">500</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> femaleHeroes = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isFemaleHero(hero)) &#123;</span><br><span class="line">        femaleHeroes.push(hero);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> superhumans = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> hero <span class="keyword">of</span> heroes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isSuperhuman(hero)) &#123;</span><br><span class="line">        superhumans.push(hero);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时就可以抽象成JavaScript内置的<code>filter</code>函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">predicate, arr</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> working = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (predicate(item)) &#123;</span><br><span class="line"></span><br><span class="line">            working = working.concat(item);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> femaleHeroes = filter(isFemaleHero, heroes);</span><br><span class="line"><span class="keyword">const</span> superhumans  = filter(isSuperhuman, heroes);</span><br></pre></td></tr></table></figure>

<h2 id="Finding"><a href="#Finding" class="headerlink" title="Finding"></a>Finding</h2><p><code>filter</code>搞定了，那么如果我们只要找到一个元素呢。</p>
<p>的确，我们同样可以使用<code>filter</code>函数完成这个目标，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isBlackWidow</span>(<span class="params">hero</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (hero.name === <span class="string">&#x27;Black Widow&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> blackWidow = heroes.filter(isBlackWidow)[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>

<p>当然我们也同样会发现，这样的效率并不高。因为<code>filter</code>函数会过滤所有的元素，尽管在前面已经找到了应该要找到的元素。因此我们可以写一个这样的查找函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params">predicate, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (predicate(item)) &#123;</span><br><span class="line">            <span class="keyword">return</span> item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> blackWidow = find(isBlackWidow, heroes);</span><br></pre></td></tr></table></figure>

<p>正如大家所预期那样，JavaScript也同样提供了内置方法<code>find</code>给我们，因此我们最终的代码是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> blackWidow = heroes.find(isBlackWidow);</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这些JavaScript内置的数组函数就是很好的例子，让我们学会了如何去抽象提取共同部分，以创造一个可以复用的函数。</p>
<p>现在我们可以用内置函数完成几乎所有的数组操作。分析一下，我们可以看出每个函数都有以下特点：</p>
<ol>
<li>摒弃了循环的控制结构，使代码更容易阅读。</li>
<li>通过使用适当的方法名称描述我们正在使用的方法。</li>
<li>减少了处理整个数组的问题，只需要关注我们的业务代码。</li>
</ol>
<p>在每种情况下，JavaScript的内置函数都已经将问题分解为使用小的纯函数的解决方案。通过学习这几种内置函数能让我们消除几乎所有的循环结构，这是因为我们写的几乎所有循环都是在处理数组或者构建数组或者两者都有。因此使用内置函数不仅让我们在消除循环的同时，也为我们的代码增加了不少地可维护性。</p>
<p>本文翻译自：<a target="_blank" rel="noopener" href="http://jrsinclair.com/articles/2017/javascript-without-loops/?utm_source=javascriptweekly&utm_medium=email">JavaScript Without Loops</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>正确使用JavaScript数组</p><p><a href="http://africans.com/2017/02/21/javascript-without-loops/">http://africans.com/2017/02/21/javascript-without-loops/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>leejimqiu</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2017-02-21</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2020-05-23</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/JavaScript/">JavaScript</a><a class="link-muted mr-2" rel="tag" href="/tags/Array/">Array</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2017/03/05/memory-management/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">JavaScript 内存管理</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2016/11/24/some-summarize-about-event/"><span class="level-item">关于事件绑定的一些知识</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://wx.qlogo.cn/mmhead/PiajxSqBRaEKzztxtaqGaVk8KzgrnxCBJkB6RD6rEqGOicBLVhnzxM7g/0" alt="leejimqiu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">leejimqiu</p><p class="is-size-6 is-block">Senior Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shenzhen, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">44</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">33</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/leejim" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/leejim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weixin" href="https://developers.weixin.qq.com/community/personal/oCJUsw4DgF0046Dd6X7b5Lm-INBA"><i class="fab fa-weixin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://tdesign.tencent.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">TDesign</span></span><span class="level-right"><span class="level-item tag">tdesign.tencent.com</span></span></a></li><li><a class="level is-mobile" href="https://tdesign.tencent.com/miniprogram" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">TDesign Miniprogram</span></span><span class="level-right"><span class="level-item tag">tdesign.tencent.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-06T12:21:28.000Z">2022-01-06</time></p><p class="title"><a href="/2022/01/06/miniprogram-function-property/">小程序自定义组件的函数属性及事件触发</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-17T06:59:13.000Z">2021-01-17</time></p><p class="title"><a href="/2021/01/17/promise/">前端进阶 - Promise原理&amp;宏微任务</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-05-23T06:40:56.000Z">2020-05-23</time></p><p class="title"><a href="/2020/05/23/mini-program/update/">自动更新机制</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-05-23T06:40:41.000Z">2020-05-23</time></p><p class="title"><a href="/2020/05/23/mini-program/thinking-about-components/">组件封装的思考</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-05-23T06:40:26.000Z">2020-05-23</time></p><p class="title"><a href="/2020/05/23/mini-program/think-about-subscribe/">订阅消息的思考</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">March 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/02/"><span class="level-start"><span class="level-item">February 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">November 2016</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/10/"><span class="level-start"><span class="level-item">October 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/09/"><span class="level-start"><span class="level-item">September 2016</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/08/"><span class="level-start"><span class="level-item">August 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/07/"><span class="level-start"><span class="level-item">July 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/05/"><span class="level-start"><span class="level-item">May 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/10/"><span class="level-start"><span class="level-item">October 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/09/"><span class="level-start"><span class="level-item">September 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Array/"><span class="tag">Array</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFC/"><span class="tag">BFC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buffers/"><span class="tag">Buffers</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ES6/"><span class="tag">ES6</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTML/"><span class="tag">HTML</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTTP/"><span class="tag">HTTP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/History-API/"><span class="tag">History API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Node-js/"><span class="tag">Node.js</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Session/"><span class="tag">Session</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Storage/"><span class="tag">Storage</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cookie/"><span class="tag">cookie</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gulp/"><span class="tag">gulp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/promise-%E5%AE%8F%E4%BB%BB%E5%8A%A1-%E5%BE%AE%E4%BB%BB%E5%8A%A1/"><span class="tag">promise 宏任务 微任务</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tdesign/"><span class="tag">tdesign</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/underscore-js/"><span class="tag">underscore.js</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue-js/"><span class="tag">vue.js</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8B%E4%BB%B6/"><span class="tag">事件</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"><span class="tag">内存管理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%87%BD%E6%95%B0/"><span class="tag">函数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%87%BD%E6%95%B0%E5%B1%9E%E6%80%A7/"><span class="tag">函数属性</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"><span class="tag">垃圾回收</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><span class="tag">小程序</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B1%9E%E6%80%A7/"><span class="tag">属性</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E5%9D%97%E5%8C%96/"><span class="tag">模块化</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9B%92%E6%A8%A1%E5%9E%8B/"><span class="tag">盒模型</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/"><span class="tag">编码规范</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"><span class="tag">网络安全</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%AF%E7%94%B1/"><span class="tag">路由</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%94%AE%E7%9B%98/"><span class="tag">键盘</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%97%AD%E5%8C%85/"><span class="tag">闭包</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Jim Home" height="28"></a><p class="is-size-7"><span>&copy; 2022 leejimqiu</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/leejim"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>